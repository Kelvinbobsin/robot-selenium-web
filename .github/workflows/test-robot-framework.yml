name: Testes com Robot Framework e SeleniumLibrary

on: [push, pull_request]

jobs:
  test:
    runs-on: ubuntu-latest

    steps:
    - name: Checkout do código
      uses: actions/checkout@v2

    - name: Configurar ChromeDriver e Chrome
      run: |
        apt-get update && apt-get install -y wget curl unzip
        wget http://mirror.cs.uchicago.edu/google-chrome/pool/main/g/google-chrome-stable/google-chrome-stable_100.0.4896.127-1_amd64.deb
        apt-get -y install ./google-chrome-stable_100.0.4896.127-1_amd64.deb
        google-chrome-stable --version

        # Instala o ChromeDriver versão 110
        wget "https://chromedriver.storage.googleapis.com/100.0.4896.20/chromedriver_linux64.zip" -O chromedriver.zip
        unzip -d chromedriver chromedriver.zip
        chmod +x chromedriver/chromedriver
        mv chromedriver/chromedriver /usr/local/bin/

    - name: Instalar dependências
      run: |
        pip install -r requirements.txt

    - name: Executar testes
      run: |
        robot -d results teste2.robot
        cp results/output.xml $GITHUB_WORKSPACE/results/
        cp results/log.html $GITHUB_WORKSPACE/results/
        cp results/report.html $GITHUB_WORKSPACE/results/
